# Exercises

1. Create a struct named `Person` with three fields: `FirstName` and `LastName` of type `string` and `Age` of type `int`. Write a function called `MakePerson` that takes in firstName, lastName, and age and returns a Person. Write a second function `MakePersonPointer` that takes in firstName, lastName, and age and returns a *Person. Call both from main. Compile your program with `go build -gcflags="-m"`. This both compiles your code and prints out which values escape to the heap. 

```go
package main

import (
	"fmt"
)

type Person struct {
	FirstName string
	LastName  string
	Age       int
}

// constructs and returns a Person by value
func MakePerson(firstName, lastName string, age int) Person {
	return Person{
		FirstName: firstName,
		LastName:  lastName,
		Age:       age,
	}
}

func MakePersonPointer(firstName, lastName string, age int) *Person {
	// this literal must live beyond the stack frame, so it will escape
	return &Person{
		FirstName: firstName,
		LastName:  lastName,
		Age:       age,
	}
}

func main() {
	p1 := MakePerson("Alice", "Anderson", 30)
	p2 := MakePersonPointer("Bob", "Brown", 40)

    // even though p1 lives in main's frame, its strings themselves
    // pint to the global read-only data. The struct value itself does not escape.
	fmt.Printf("MakePerson returns: %#v (addr=%p)\n", p1, &p1)

	// MakePersonPointer must allocate a Person on the heap
	// so &Person{...} can be returned safely
	fmt.Printf("MakePersonPointer returns: %#v (addr=%p)\n", p2, p2)
}
```

```sh
chan@CMA:~/Go_Programming/ch1$ make
go fmt ./...
hello.go
go vet ./...
go build -gcflags="-m"
# hello_world
./hello.go:14:6: can inline MakePerson
./hello.go:22:6: can inline MakePersonPointer
./hello.go:32:18: inlining call to MakePerson
./hello.go:33:25: inlining call to MakePersonPointer
./hello.go:35:12: inlining call to fmt.Printf
./hello.go:39:12: inlining call to fmt.Printf
./hello.go:14:17: leaking param: firstName to result ~r0 level=0
./hello.go:14:28: leaking param: lastName to result ~r0 level=0
./hello.go:22:24: leaking param: firstName
./hello.go:22:35: leaking param: lastName
./hello.go:24:9: &Person{...} escapes to heap
./hello.go:32:2: moved to heap: p1
./hello.go:33:25: &Person{...} escapes to heap
./hello.go:35:12: ... argument does not escape
./hello.go:35:52: p1 escapes to heap
./hello.go:39:12: ... argument does not escape
chan@CMA:~/Go_Programming/ch1$ ./hello_world
MakePerson returns: main.Person{FirstName:"Alice", LastName:"Anderson", Age:30} (addr=0xc000100090)
MakePersonPointer returns: &main.Person{FirstName:"Bob", LastName:"Brown", Age:40} (addr=0xc0001000c0)
```

---

