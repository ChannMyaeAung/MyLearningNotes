# Synchronization with `sync`

- Sometimes we need to wait for a set of goroutines to finish.
- We can use `sync.WaitGroup`.
- **`sync.WaitGroup`:**
  - Used to wait for a collection of goroutines to finish executing.
  - `Add(delta int)`: Increments a counter that tracks how many concurrent operations (usually goroutines) the program must wait for before unblocking a `Wait()` call.
    - Calling `wg.Add(1)` before spawning a goroutine ensures that `wg.Wait()` will block until that goroutine signals completion with `wg.Done()`
  - `Done()`: Decrements the counter (usually called by the goroutine when it finishes, often via `defer wg.Done()`).
  - `Wait()`: Blocks until the counter becomes zero.



```go
package main

import (
	"fmt"
	"sync"
	"time"
)

var wg sync.WaitGroup

func worker(id int) {
	defer wg.Done()
	fmt.Printf("Worker %d working\n", id)
	time.Sleep(time.Second)
}

func main() {
	for i := 1; i <= 3; i++ {
		wg.Add(1)
		go worker(i)
	}
	wg.Wait() // block until all wg.Done() calls happen
	fmt.Println("all workers done")
}
```

```sh
chan@CMA:~/Go_Programming/practice$ make
go fmt ./...
practice.go
go vet ./...
go build
chan@CMA:~/Go_Programming/practice$ ./practice
Worker 3 working
Worker 1 working
Worker 2 working
all workers done
```

