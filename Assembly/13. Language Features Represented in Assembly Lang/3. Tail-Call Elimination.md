# Tail-Call Elimination

- To mitigate against overusage of stack space, programming languages often implement tail-call elimination.
- The idea behind this is that if the last thing that a function does is return the value of another function call (it doesn't need to process that value or anything, just return it), then at the point of the call, the stack frame is actually not needed.

```assembly
.globl factorial
.section .text 
factorial:
    # no stack frame needed, just get ready to call factorial_internal 

    # %rdi already has number, 
    # value_so_far gets set to 1 
    movq $1, %rsi 

    # we can eliminate this as a tail call as well!
    jmp factorial_internal 

factorial_internal:
    # no stack frame needed
    # %rdi has number 
    # %rsi has value_so_far

    cmpq $1, %rdi 
    je factorial_internal_completion 

    # multiply number and value_so_far
    movq %rsi, %rax 
    mulq %rdi 

    # next value 
    decq %rdi # num 
    movq %rax, %rsi # value_so_far 

    # Tail call elimination
    jmp factorial_internal 

factorial_internal_completion:
    # this is the base case - return value_so_far
    movq %rsi, %rax 
    ret 
```

