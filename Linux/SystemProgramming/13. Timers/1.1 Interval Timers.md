# Interval timers

- Allows a process to setup and query a timer that can be programmed to auto-recur at a fixed time interval.

```c
#include <sys/time.h>
int getitimer(int which, struct itimerval *curr_value);
int setitimer(int which, const struct itimerval *new_value, struct itimerval *old_value);
```

- The `setitimer(2)` is used to setup a new timer, the `getitimer(2)` can be used to query it, and returns the time remaining.

- 1st param (`which`): specifies the type of timer to use.

  - `ITIMER_REAL`: To count down in real-time, which is also called **wall clock time**. 
  - `ITIMER_VIRTUAL`: to count down in virtual time. The timer only counts down when the calling process (all threads) is running in user space on the CPU.
  - `ITIMER_PROF`: to count down in virtual time too. The timer counts down when the calling process (all threads) is running in both user-space and/or kernel space on the CPU.
  - Upon all those types timer expiry, the kernel sends `SIGALRM` to the calling process.

- 2nd param (`itimerval`) of `getitimer()`: 

  - ```c
    struct itimerval{
        struct timeval it_interval; // interval for periodic timer
        struct timeval it_value; // time until next expiration
    }
    
    struct timeval{
        time_t tv_sec; // seconds
        suseconds_t tv_usec; // microseconds
    }
    ```

  - Both the internal `time_t` and the `suseconds_t` typedefs translate to a long (integer) value.

- 2nd param of `setitimer(2)`: a pointer to struct `itimerval` called `new_value`.

  - It is where we specify the new timer's expiration times.